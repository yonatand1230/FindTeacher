<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Teacher</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script>
        // Sort Teachers func
        function sortTeachers(teachers) {
            var sorted = [];
            var rabbies = [];
            // remove "הרב" substring
            for (let i = 0; i < teachers.length; i++) {
                let teach = teachers[i];
                sorted.push(teach.replaceAll("הרב ", ""));
                if (teach.includes("הרב ")) {
                    rabbies.push(teach.replaceAll("הרב ", ""));
                }
            }
            sorted.sort();

            // re-add "הרב" after sorting
            rabbies.forEach(rav => {
                let rav_idx = sorted.indexOf(rav);
                sorted[rav_idx] = "הרב " + sorted[rav_idx]
            });

            return sorted;
        }
        function displayText(text) {
            let p = document.getElementById("text");
            p.innerHTML = text;
        }
        function teacherSelected() {
            let select = document.getElementById("select-teacher");
            let teacher = select.value;
            let p = document.getElementById("text");
            displayText(teacher);

        }

        // Get Schedule
        let scheduleUrl = "https://raw.githubusercontent.com/yonatand1230/FindTeacher/refs/heads/main/schedule.json"
        fetch(scheduleUrl)
            .then(response => {
                return response.json();
            })
            .then(schedule => {
                let options_source = Object.keys(schedule);
                options_source.splice(options_source.indexOf(""), 1);
                var options = sortTeachers(options_source);
                var options_html = [];
                options.forEach(opt => {
                    element = document.createElement("option");
                    element.value = opt;
                    element.innerHTML = opt;
                    select = document.getElementById("select-teacher");
                    select.appendChild(element);
                });
            })
            .then(opt_element => {
                select =
                    console.log(select)
            })
    </script>
</head>

<body>
    <div id="root">
        <div class="container mt-5">
            <div class="border p-4" style="border-color: blue;">
                <h2 dir="rtl" style="float: right">איתור מורה</h2>
                <div class="form-group">
                    <label style="float: right">בחירת מורה:          </label>
                    <select class="form-control" id="select-teacher" onchange="teacherSelected()">
                    </select>
                </div>
                <p id="text"></p>
            </div>
        </div>
    </div>
</body>
<html>